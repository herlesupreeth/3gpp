#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "kdf.h"


uint8  K_ASME[32] = {
 0x26, 0x1C, 0xAA, 0x51, 0xBC, 0xF6, 0xD5, 0xD7,
 0xA9, 0x39, 0x16, 0xDB, 0xF6, 0xB6, 0x3D, 0x8B,
 0xBC, 0xD1, 0x88, 0x35, 0x8F, 0x23, 0xCF, 0xB8,
 0x4F, 0x29, 0x15, 0x16, 0xB1, 0x3F, 0x53, 0xE1
};
uint8  K_eNB[32] = {
 0xAF, 0x64, 0xA6, 0x5E, 0x5C, 0x77, 0x5B, 0x28,
 0x03, 0x30, 0xD6, 0xE7, 0x9D, 0x09, 0xCD, 0xA2,
 0x91, 0xA8, 0x3C, 0xAC, 0xE5, 0xEC, 0x46, 0x0F,
 0x75, 0xDB, 0x99, 0x99, 0x7B, 0x3F, 0x84, 0xA5
};

int main(void)
{
    uint8  KEY[32];
    uint8  S[36];
    uint8  K_NH[32];


    memcpy(KEY, K_ASME, 32);

    S[0]  = 0x12;
    memcpy(S+1, K_eNB, 32);
    S[33] = 0x00;
    S[34] = 0x20;

    //mem_dump("Key", KEY, 32);
    //mem_dump("S", S, 35);

    kdf(KEY, 32, S, 35, K_NH);
    mem_dump("K_NH", K_NH, 32);


    return 0;
}

