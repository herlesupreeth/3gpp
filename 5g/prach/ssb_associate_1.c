#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <math.h>

#define DIV_CEIL(X, Y)  (((X) + ((Y) - 1)) / (Y))
#define DIV_FLOOR(X, Y) ((X) / (Y))


typedef enum
{
    PRACH_SCS_1D25_5_15_60,
    PRACH_SCS_30_120
} tDeltaFRA;


/* Random access configurations:
 *   g_raConfig[][][0] = PRACH cnofiguration index
 *   g_raConfig[][][1] = Starting symbol
 *   g_raConfig[][][2] = Number of PRACH slots within a subframe
 *   g_raConfig[][][3] = Number of time domain PRACH occasions within a PRACH slot
 *   g_raConfig[][][4] = PRACH duration
 */
int g_raConfig[3][256][5] = {
    /* 0: FR1 paired */
    {
        {   0,  0,  -1,  -1,  0  },
        {   1,  0,  -1,  -1,  0  },
        {   2,  0,  -1,  -1,  0  },
        {   3,  0,  -1,  -1,  0  },
        {   4,  0,  -1,  -1,  0  },
        {   5,  0,  -1,  -1,  0  },
        {   6,  0,  -1,  -1,  0  },
        {   7,  0,  -1,  -1,  0  },
        {   8,  0,  -1,  -1,  0  },
        {   9,  0,  -1,  -1,  0  },
        {  10,  0,  -1,  -1,  0  },
        {  11,  0,  -1,  -1,  0  },
        {  12,  0,  -1,  -1,  0  },
        {  13,  0,  -1,  -1,  0  },
        {  14,  0,  -1,  -1,  0  },
        {  15,  0,  -1,  -1,  0  },
        {  16,  0,  -1,  -1,  0  },
        {  17,  0,  -1,  -1,  0  },
        {  18,  0,  -1,  -1,  0  },
        {  19,  0,  -1,  -1,  0  },
        {  20,  0,  -1,  -1,  0  },
        {  21,  0,  -1,  -1,  0  },
        {  22,  0,  -1,  -1,  0  },
        {  23,  0,  -1,  -1,  0  },
        {  24,  0,  -1,  -1,  0  },
        {  25,  0,  -1,  -1,  0  },
        {  26,  0,  -1,  -1,  0  },
        {  27,  0,  -1,  -1,  0  },
        {  28,  0,  -1,  -1,  0  },
        {  29,  0,  -1,  -1,  0  },
        {  30,  0,  -1,  -1,  0  },
        {  31,  0,  -1,  -1,  0  },
        {  32,  0,  -1,  -1,  0  },
        {  33,  0,  -1,  -1,  0  },
        {  34,  0,  -1,  -1,  0  },
        {  35,  0,  -1,  -1,  0  },
        {  36,  0,  -1,  -1,  0  },
        {  37,  0,  -1,  -1,  0  },
        {  38,  0,  -1,  -1,  0  },
        {  39,  0,  -1,  -1,  0  },
        {  40,  0,  -1,  -1,  0  },
        {  41,  0,  -1,  -1,  0  },
        {  42,  0,  -1,  -1,  0  },
        {  43,  0,  -1,  -1,  0  },
        {  44,  0,  -1,  -1,  0  },
        {  45,  0,  -1,  -1,  0  },
        {  46,  0,  -1,  -1,  0  },
        {  47,  0,  -1,  -1,  0  },
        {  48,  0,  -1,  -1,  0  },
        {  49,  0,  -1,  -1,  0  },
        {  50,  0,  -1,  -1,  0  },
        {  51,  0,  -1,  -1,  0  },
        {  52,  0,  -1,  -1,  0  },
        {  53,  0,  -1,  -1,  0  },
        {  54,  0,  -1,  -1,  0  },
        {  55,  0,  -1,  -1,  0  },
        {  56,  0,  -1,  -1,  0  },
        {  57,  0,  -1,  -1,  0  },
        {  58,  0,  -1,  -1,  0  },
        {  59,  0,  -1,  -1,  0  },
        {  60,  0,  -1,  -1,  0  },
        {  61,  0,  -1,  -1,  0  },
        {  62,  0,  -1,  -1,  0  },
        {  63,  0,  -1,  -1,  0  },
        {  64,  0,  -1,  -1,  0  },
        {  65,  0,  -1,  -1,  0  },
        {  66,  0,  -1,  -1,  0  },
        {  67,  0,  -1,  -1,  0  },
        {  68,  0,  -1,  -1,  0  },
        {  69,  0,  -1,  -1,  0  },
        {  70,  0,  -1,  -1,  0  },
        {  71,  0,  -1,  -1,  0  },
        {  72,  0,  -1,  -1,  0  },
        {  73,  0,  -1,  -1,  0  },
        {  74,  0,  -1,  -1,  0  },
        {  75,  0,  -1,  -1,  0  },
        {  76,  0,  -1,  -1,  0  },
        {  77,  0,  -1,  -1,  0  },
        {  78,  0,  -1,  -1,  0  },
        {  79,  0,  -1,  -1,  0  },
        {  80,  0,  -1,  -1,  0  },
        {  81,  0,  -1,  -1,  0  },
        {  82,  0,  -1,  -1,  0  },
        {  83,  0,  -1,  -1,  0  },
        {  84,  0,  -1,  -1,  0  },
        {  85,  0,  -1,  -1,  0  },
        {  86,  0,  -1,  -1,  0  },
        {  87,  0,   1,   6,  2  },
        {  88,  0,   2,   6,  2  },
        {  89,  0,   1,   6,  2  },
        {  90,  0,   2,   6,  2  },
        {  91,  0,   1,   6,  2  },
        {  92,  0,   1,   6,  2  },
        {  93,  0,   2,   6,  2  },
        {  94,  0,   1,   6,  2  },
        {  95,  0,   2,   6,  2  },
        {  96,  0,   2,   6,  2  },
        {  97,  0,   2,   6,  2  },
        {  98,  0,   1,   6,  2  },
        {  99,  0,   1,   6,  2  },
        { 100,  0,   1,   6,  2  },
        { 101,  0,   2,   6,  2  },
        { 102,  0,   2,   6,  2  },
        { 103,  0,   2,   6,  2  },
        { 104,  0,   2,   6,  2  },
        { 105,  0,   2,   6,  2  },
        { 106,  0,   2,   6,  2  },
        { 107,  0,   2,   6,  2  },
        { 108,  0,   1,   7,  2  },
        { 109,  0,   2,   7,  2  },
        { 110,  0,   1,   7,  2  },
        { 111,  0,   1,   7,  2  },
        { 112,  0,   1,   7,  2  },
        { 113,  0,   2,   7,  2  },
        { 114,  0,   2,   7,  2  },
        { 115,  0,   2,   7,  2  },
        { 116,  0,   2,   7,  2  },
        { 117,  0,   1,   3,  4  },
        { 118,  0,   2,   3,  4  },
        { 119,  0,   1,   3,  4  },
        { 120,  0,   2,   3,  4  },
        { 121,  0,   1,   3,  4  },
        { 122,  0,   2,   3,  4  },
        { 123,  0,   1,   3,  4  },
        { 124,  0,   2,   3,  4  },
        { 125,  0,   2,   3,  4  },
        { 126,  0,   2,   3,  4  },
        { 127,  0,   1,   3,  4  },
        { 128,  0,   1,   3,  4  },
        { 129,  0,   1,   3,  4  },
        { 130,  0,   2,   3,  4  },
        { 131,  0,   2,   3,  4  },
        { 132,  0,   2,   3,  4  },
        { 133,  0,   2,   3,  4  },
        { 134,  0,   2,   3,  4  },
        { 135,  0,   2,   3,  4  },
        { 136,  0,   2,   3,  4  },
        { 137,  0,   1,   3,  4  },
        { 138,  0,   2,   3,  4  },
        { 139,  0,   1,   3,  4  },
        { 140,  0,   1,   3,  4  },
        { 141,  0,   1,   3,  4  },
        { 142,  0,   2,   3,  4  },
        { 143,  0,   2,   3,  4  },
        { 144,  0,   2,   3,  4  },
        { 145,  0,   2,   3,  4  },
        { 146,  0,   2,   3,  4  },
        { 147,  0,   1,   2,  6  },
        { 148,  0,   2,   2,  6  },
        { 149,  0,   1,   2,  6  },
        { 150,  0,   2,   2,  6  },
        { 151,  0,   1,   2,  6  },
        { 152,  0,   2,   2,  6  },
        { 153,  0,   2,   2,  6  },
        { 154,  0,   2,   2,  6  },
        { 155,  0,   2,   2,  6  },
        { 156,  0,   2,   2,  6  },
        { 157,  0,   1,   2,  6  },
        { 158,  0,   1,   2,  6  },
        { 159,  0,   1,   2,  6  },
        { 160,  0,   2,   2,  6  },
        { 161,  0,   2,   2,  6  },
        { 162,  0,   2,   2,  6  },
        { 163,  0,   2,   2,  6  },
        { 164,  0,   2,   2,  6  },
        { 165,  0,   2,   2,  6  },
        { 166,  0,   2,   2,  6  },
        { 167,  0,   2,   2,  6  },
        { 168,  0,   2,   2,  6  },
        { 169,  0,   1,   2,  6  },
        { 170,  0,   1,   2,  6  },
        { 171,  0,   1,   2,  6  },
        { 172,  0,   2,   2,  6  },
        { 173,  0,   2,   2,  6  },
        { 174,  0,   2,   2,  6  },
        { 175,  0,   2,   2,  6  },
        { 176,  0,   2,   2,  6  },
        { 177,  0,   1,   7,  2  },
        { 178,  0,   2,   7,  2  },
        { 179,  0,   1,   7,  2  },
        { 180,  0,   2,   7,  2  },
        { 181,  0,   1,   7,  2  },
        { 182,  0,   1,   7,  2  },
        { 183,  0,   2,   7,  2  },
        { 184,  0,   1,   7,  2  },
        { 185,  0,   2,   7,  2  },
        { 186,  0,   2,   7,  2  },
        { 187,  0,   2,   7,  2  },
        { 188,  0,   1,   7,  2  },
        { 189,  0,   1,   7,  2  },
        { 190,  0,   1,   7,  2  },
        { 191,  0,   2,   7,  2  },
        { 192,  0,   2,   7,  2  },
        { 193,  0,   2,   7,  2  },
        { 194,  0,   2,   7,  2  },
        { 195,  0,   2,   7,  2  },
        { 196,  0,   2,   7,  2  },
        { 197,  0,   2,   7,  2  },
        { 198,  0,   2,   1,  12 },
        { 199,  0,   2,   1,  12 },
        { 200,  0,   2,   1,  12 },
        { 201,  0,   2,   1,  12 },
        { 202,  0,   2,   1,  12 },
        { 203,  0,   2,   1,  12 },
        { 204,  0,   2,   1,  12 },
        { 205,  0,   2,   1,  12 },
        { 206,  0,   2,   1,  12 },
        { 207,  0,   2,   1,  12 },
        { 208,  0,   2,   1,  12 },
        { 209,  0,   2,   1,  12 },
        { 210,  0,   2,   1,  12 },
        { 211,  0,   2,   1,  12 },
        { 212,  0,   2,   1,  12 },
        { 213,  0,   2,   1,  12 },
        { 214,  0,   2,   1,  12 },
        { 215,  0,   2,   1,  12 },
        { 216,  0,   2,   1,  12 },
        { 217,  0,   2,   1,  12 },
        { 218,  0,   2,   1,  12 },
        { 219,  0,   2,   7,  2  },
        { 220,  0,   1,   7,  2  },
        { 221,  0,   2,   7,  2  },
        { 222,  0,   1,   7,  2  },
        { 223,  0,   2,   7,  2  },
        { 224,  0,   2,   7,  2  },
        { 225,  0,   2,   7,  2  },
        { 226,  0,   1,   7,  2  },
        { 227,  0,   1,   7,  2  },
        { 228,  0,   1,   7,  2  },
        { 229,  0,   2,   7,  2  },
        { 230,  0,   2,   7,  2  },
        { 231,  0,   2,   7,  2  },
        { 232,  0,   2,   7,  2  },
        { 233,  0,   2,   7,  2  },
        { 234,  0,   2,   7,  2  },
        { 235,  0,   2,   7,  2  },
        { 236,  0,   1,   2,  6  },
        { 237,  0,   2,   2,  6  },
        { 238,  0,   1,   2,  6  },
        { 239,  0,   2,   2,  6  },
        { 240,  0,   1,   2,  6  },
        { 241,  0,   2,   2,  6  },
        { 242,  0,   2,   2,  6  },
        { 243,  0,   2,   2,  6  },
        { 244,  0,   2,   2,  6  },
        { 245,  0,   2,   2,  6  },
        { 246,  0,   1,   2,  6  },
        { 247,  0,   1,   2,  6  },
        { 248,  0,   1,   2,  6  },
        { 249,  0,   2,   2,  6  },
        { 250,  0,   2,   2,  6  },
        { 251,  0,   2,   2,  6  },
        { 252,  0,   2,   2,  6  },
        { 253,  0,   2,   2,  6  },
        { 254,  0,   2,   2,  6  },
        { 255,  0,   2,   2,  6  }
    },
    /* 1: FR1 unpaired */
    {
        {   0,  0,  -1,  -1,  0  },
        {   1,  0,  -1,  -1,  0  },
        {   2,  0,  -1,  -1,  0  },
        {   3,  0,  -1,  -1,  0  },
        {   4,  0,  -1,  -1,  0  },
        {   5,  0,  -1,  -1,  0  },
        {   6,  0,  -1,  -1,  0  },
        {   7,  0,  -1,  -1,  0  },
        {   8,  0,  -1,  -1,  0  },
        {   9,  0,  -1,  -1,  0  },
        {  10,  0,  -1,  -1,  0  },
        {  11,  0,  -1,  -1,  0  },
        {  12,  0,  -1,  -1,  0  },
        {  13,  0,  -1,  -1,  0  },
        {  14,  0,  -1,  -1,  0  },
        {  15,  0,  -1,  -1,  0  },
        {  16,  7,  -1,  -1,  0  },
        {  17,  0,  -1,  -1,  0  },
        {  18,  0,  -1,  -1,  0  },
        {  19,  0,  -1,  -1,  0  },
        {  20,  0,  -1,  -1,  0  },
        {  21,  0,  -1,  -1,  0  },
        {  22,  0,  -1,  -1,  0  },
        {  23,  0,  -1,  -1,  0  },
        {  24,  0,  -1,  -1,  0  },
        {  25,  0,  -1,  -1,  0  },
        {  26,  0,  -1,  -1,  0  },
        {  27,  0,  -1,  -1,  0  },
        {  28,  0,  -1,  -1,  0  },
        {  29,  0,  -1,  -1,  0  },
        {  30,  0,  -1,  -1,  0  },
        {  31,  0,  -1,  -1,  0  },
        {  32,  0,  -1,  -1,  0  },
        {  33,  0,  -1,  -1,  0  },
        {  34,  0,  -1,  -1,  0  },
        {  35,  0,  -1,  -1,  0  },
        {  36,  0,  -1,  -1,  0  },
        {  37,  7,  -1,  -1,  0  },
        {  38,  7,  -1,  -1,  0  },
        {  39,  7,  -1,  -1,  0  },
        {  40,  0,  -1,  -1,  0  },
        {  41,  0,  -1,  -1,  0  },
        {  42,  0,  -1,  -1,  0  },
        {  43,  0,  -1,  -1,  0  },
        {  44,  0,  -1,  -1,  0  },
        {  45,  0,  -1,  -1,  0  },
        {  46,  0,  -1,  -1,  0  },
        {  47,  0,  -1,  -1,  0  },
        {  48,  0,  -1,  -1,  0  },
        {  49,  0,  -1,  -1,  0  },
        {  50,  0,  -1,  -1,  0  },
        {  51,  0,  -1,  -1,  0  },
        {  52,  0,  -1,  -1,  0  },
        {  53,  0,  -1,  -1,  0  },
        {  54,  0,  -1,  -1,  0  },
        {  55,  0,  -1,  -1,  0  },
        {  56,  7,  -1,  -1,  0  },
        {  57,  0,  -1,  -1,  0  },
        {  58,  0,  -1,  -1,  0  },
        {  59,  0,  -1,  -1,  0  },
        {  60,  0,  -1,  -1,  0  },
        {  61,  0,  -1,  -1,  0  },
        {  62,  0,  -1,  -1,  0  },
        {  63,  0,  -1,  -1,  0  },
        {  64,  0,  -1,  -1,  0  },
        {  65,  0,  -1,  -1,  0  },
        {  66,  0,  -1,  -1,  0  },
        {  67,  0,   2,   6,  2  },
        {  68,  0,   2,   6,  2  },
        {  69,  0,   1,   6,  2  },
        {  70,  0,   1,   6,  2  },
        {  71,  7,   1,   3,  2  },
        {  72,  7,   1,   3,  2  },
        {  73,  0,   1,   6,  2  },
        {  74,  0,   2,   6,  2  },
        {  75,  0,   2,   6,  2  },
        {  76,  0,   1,   6,  2  },
        {  77,  0,   2,   6,  2  },
        {  78,  7,   1,   3,  2  },
        {  79,  0,   1,   6,  2  },
        {  80,  0,   2,   6,  2  },
        {  81,  0,   1,   6,  2  },
        {  82,  7,   1,   3,  2  },
        {  83,  0,   1,   6,  2  },
        {  84,  0,   2,   6,  2  },
        {  85,  0,   1,   6,  2  },
        {  86,  7,   1,   3,  2  },
        {  87,  0,   2,   3,  4  },
        {  88,  0,   2,   3,  4  },
        {  89,  0,   1,   3,  4  },
        {  90,  0,   1,   3,  4  },
        {  91,  0,   2,   3,  4  },
        {  92,  9,   1,   1,  4  },
        {  93,  9,   1,   1,  4  },
        {  94,  0,   2,   3,  4  },
        {  95,  0,   1,   3,  4  },
        {  96,  0,   1,   3,  4  },
        {  97,  0,   1,   3,  4  },
        {  98,  0,   1,   3,  4  },
        {  99,  0,   2,   3,  4  },
        { 100,  9,   1,   1,  4  },
        { 101,  0,   1,   3,  4  },
        { 102,  0,   1,   3,  4  },
        { 103,  0,   2,   3,  4  },
        { 104,  0,   1,   3,  4  },
        { 105,  9,   1,   1,  4  },
        { 106,  0,   1,   3,  4  },
        { 107,  0,   2,   3,  4  },
        { 108,  0,   1,   3,  4  },
        { 109,  9,   1,   1,  4  },
        { 110,  0,   2,   2,  6  },
        { 111,  0,   2,   2,  6  },
        { 112,  0,   1,   2,  6  },
        { 113,  7,   1,   1,  6  },
        { 114,  7,   1,   1,  6  },
        { 115,  0,   1,   2,  6  },
        { 116,  0,   2,   2,  6  },
        { 117,  0,   2,   2,  6  },
        { 118,  0,   1,   2,  6  },
        { 119,  0,   1,   2,  6  },
        { 120,  0,   1,   2,  6  },
        { 121,  0,   1,   2,  6  },
        { 122,  0,   2,   2,  6  },
        { 123,  7,   1,   1,  6  },
        { 124,  0,   1,   2,  6  },
        { 125,  0,   1,   2,  6  },
        { 126,  0,   2,   2,  6  },
        { 127,  0,   1,   2,  6  },
        { 128,  7,   1,   1,  6  },
        { 129,  0,   1,   2,  6  },
        { 130,  0,   2,   2,  6  },
        { 131,  0,   1,   2,  6  },
        { 132,  7,   1,   1,  6  },
        { 133,  2,   1,   6,  2  },
        { 134,  2,   1,   6,  2  },
        { 135,  2,   1,   6,  2  },
        { 136,  8,   1,   3,  2  },
        { 137,  2,   2,   6,  2  },
        { 138,  2,   2,   6,  2  },
        { 139,  8,   1,   3,  2  },
        { 140,  2,   1,   6,  2  },
        { 141,  2,   2,   6,  2  },
        { 142,  2,   1,   6,  2  },
        { 143,  8,   1,   3,  2  },
        { 144,  2,   1,   6,  2  },
        { 145,  0,   2,   1,  12 },
        { 146,  0,   2,   1,  12 },
        { 147,  2,   1,   1,  12 },
        { 148,  0,   1,   1,  12 },
        { 149,  2,   1,   1,  12 },
        { 150,  2,   1,   1,  12 },
        { 151,  2,   1,   1,  12 },
        { 152,  0,   2,   1,  12 },
        { 153,  0,   2,   1,  12 },
        { 154,  0,   1,   1,  12 },
        { 155,  0,   1,   1,  12 },
        { 156,  0,   1,   1,  12 },
        { 157,  0,   1,   1,  12 },
        { 158,  0,   1,   1,  12 },
        { 159,  0,   1,   1,  12 },
        { 160,  2,   1,   1,  12 },
        { 161,  0,   2,   1,  12 },
        { 162,  2,   1,   1,  12 },
        { 163,  2,   1,   1,  12 },
        { 164,  0,   2,   1,  12 },
        { 165,  2,   1,   1,  12 },
        { 166,  2,   1,   1,  12 },
        { 167,  0,   2,   1,  12 },
        { 168,  2,   1,   1,  12 },
        { 169,  2,   2,   6,  2  },
        { 170,  2,   2,   6,  2  },
        { 171,  2,   1,   6,  2  },
        { 172,  2,   1,   6,  2  },
        { 173,  2,   2,   6,  2  },
        { 174,  2,   1,   6,  2  },
        { 175,  8,   1,   3,  2  },
        { 176,  8,   1,   3,  2  },
        { 177,  2,   2,   6,  2  },
        { 178,  2,   1,   6,  2  },
        { 179,  2,   2,   6,  2  },
        { 180,  8,   1,   3,  2  },
        { 181,  2,   1,   6,  2  },
        { 182,  2,   2,   6,  2  },
        { 183,  2,   1,   6,  2  },
        { 184,  8,   1,   3,  2  },
        { 185,  2,   1,   6,  2  },
        { 186,  2,   2,   6,  2  },
        { 187,  2,   1,   6,  2  },
        { 188,  8,   1,   3,  2  },
        { 189,  2,   2,   2,  6  },
        { 190,  2,   2,   2,  6  },
        { 191,  2,   1,   2,  6  },
        { 192,  2,   1,   2,  6  },
        { 193,  2,   2,   2,  6  },
        { 194,  2,   1,   2,  6  },
        { 195,  8,   1,   1,  6  },
        { 196,  8,   1,   1,  6  },
        { 197,  2,   2,   2,  6  },
        { 198,  2,   1,   2,  6  },
        { 199,  8,   2,   1,  6  },
        { 200,  8,   1,   1,  6  },
        { 201,  2,   2,   2,  6  },
        { 202,  8,   1,   1,  6  },
        { 203,  2,   1,   2,  6  },
        { 204,  2,   2,   2,  6  },
        { 205,  2,   1,   2,  6  },
        { 206,  8,   1,   1,  6  },
        { 207,  2,   1,   2,  6  },
        { 208,  2,   2,   2,  6  },
        { 209,  2,   1,   2,  6  },
        { 210,  8,   1,   1,  6  },
        { 211,  2,   1,   6,  2  },
        { 212,  8,   1,   3,  2  },
        { 213,  8,   1,   3,  2  },
        { 214,  2,   1,   6,  2  },
        { 215,  2,   2,   6,  2  },
        { 216,  2,   2,   6,  2  },
        { 217,  2,   2,   6,  2  },
        { 218,  8,   1,   3,  2  },
        { 219,  2,   1,   6,  2  },
        { 220,  2,   2,   6,  2  },
        { 221,  2,   1,   6,  2  },
        { 222,  8,   1,   3,  2  },
        { 223,  2,   2,   6,  2  },
        { 224,  2,   1,   6,  2  },
        { 225,  8,   1,   3,  2  },
        { 226,  0,   1,   3,  4  },
        { 227,  6,   1,   2,  4  },
        { 228,  6,   1,   2,  4  },
        { 229,  0,   2,   3,  4  },
        { 230,  0,   2,   3,  4  },
        { 231,  0,   2,   3,  4  },
        { 232,  6,   1,   2,  4  },
        { 233,  0,   1,   3,  4  },
        { 234,  0,   2,   3,  4  },
        { 235,  0,   1,   3,  4  },
        { 236,  6,   1,   2,  4  },
        { 237,  0,   1,   3,  4  },
        { 238,  0,   2,   3,  4  },
        { 239,  0,   1,   3,  4  },
        { 240,  6,   1,   2,  4  },
        { 241,  0,   1,   2,  6  },
        { 242,  2,   1,   2,  6  },
        { 243,  0,   1,   2,  6  },
        { 244,  2,   1,   2,  6  },
        { 245,  0,   2,   2,  6  },
        { 246,  0,   2,   2,  6  },
        { 247,  0,   2,   2,  6  },
        { 248,  2,   1,   2,  6  },
        { 249,  0,   1,   2,  6  },
        { 250,  0,   2,   2,  6  },
        { 251,  0,   1,   2,  6  },
        { 252,  2,   1,   2,  6  },
        { 253,  0,   2,   2,  6  },
        { 254,  0,   1,   2,  6  },
        { 255,  2,   1,   2,  6  }
    },
    /* 2: FR2 */
    {
        {   0,  0,   2,   6,  2  },
        {   1,  0,   1,   6,  2  },
        {   2,  0,   2,   6,  2  },
        {   3,  0,   2,   6,  2  },
        {   4,  0,   1,   6,  2  },
        {   5,  0,   1,   6,  2  },
        {   6,  0,   2,   6,  2  },
        {   7,  0,   1,   6,  2  },
        {   8,  0,   2,   6,  2  },
        {   9,  0,   1,   6,  2  },
        {  10,  0,   2,   6,  2  },
        {  11,  0,   1,   6,  2  },
        {  12,  7,   1,   3,  2  },
        {  13,  0,   1,   6,  2  },
        {  14,  7,   1,   3,  2  },
        {  15,  7,   2,   3,  2  },
        {  16,  0,   1,   6,  2  },
        {  17,  0,   2,   6,  2  },
        {  18,  0,   1,   6,  2  },
        {  19,  7,   1,   3,  2  },
        {  20,  7,   1,   3,  2  },
        {  21,  7,   1,   3,  2  },
        {  22,  0,   1,   6,  2  },
        {  23,  0,   1,   6,  2  },
        {  24,  7,   2,   3,  2  },
        {  25,  7,   1,   3,  2  },
        {  26,  0,   1,   6,  2  },
        {  27,  0,   1,   6,  2  },
        {  28,  7,   1,   3,  2  },
        {  29,  0,   2,   3,  4  },
        {  30,  0,   1,   3,  4  },
        {  31,  0,   2,   3,  4  },
        {  32,  0,   1,   3,  4  },
        {  33,  0,   2,   3,  4  },
        {  34,  0,   1,   3,  4  },
        {  35,  0,   2,   3,  4  },
        {  36,  0,   1,   3,  4  },
        {  37,  0,   2,   3,  4  },
        {  38,  0,   1,   3,  4  },
        {  39,  0,   2,   3,  4  },
        {  40,  0,   1,   3,  4  },
        {  41,  5,   1,   2,  4  },
        {  42,  0,   1,   3,  4  },
        {  43,  5,   1,   2,  4  },
        {  44,  5,   2,   2,  4  },
        {  45,  0,   1,   3,  4  },
        {  46,  0,   2,   3,  4  },
        {  47,  0,   1,   3,  4  },
        {  48,  5,   1,   2,  4  },
        {  49,  0,   1,   3,  4  },
        {  50,  5,   1,   2,  4  },
        {  51,  0,   1,   3,  4  },
        {  52,  5,   1,   2,  4  },
        {  53,  0,   1,   3,  4  },
        {  54,  5,   2,   2,  4  },
        {  55,  5,   1,   2,  4  },
        {  56,  0,   1,   3,  4  },
        {  57,  0,   1,   3,  4  },
        {  58,  5,   1,   2,  4  },
        {  59,  0,   2,   2,  6  },
        {  60,  0,   1,   2,  6  },
        {  61,  0,   2,   2,  6  },
        {  62,  0,   1,   2,  6  },
        {  63,  0,   2,   2,  6  },
        {  64,  0,   1,   2,  6  },
        {  65,  0,   2,   2,  6  },
        {  66,  0,   1,   2,  6  },
        {  67,  0,   1,   2,  6  },
        {  68,  0,   2,   2,  6  },
        {  69,  0,   1,   2,  6  },
        {  70,  7,   1,   1,  6  },
        {  71,  0,   1,   2,  6  },
        {  72,  2,   1,   2,  6  },
        {  73,  7,   1,   1,  6  },
        {  74,  7,   2,   1,  6  },
        {  75,  0,   1,   2,  6  },
        {  76,  0,   2,   2,  6  },
        {  77,  0,   1,   2,  6  },
        {  78,  7,   1,   1,  6  },
        {  79,  0,   1,   2,  6  },
        {  80,  0,   1,   2,  6  },
        {  81,  7,   1,   1,  6  },
        {  82,  0,   1,   2,  6  },
        {  83,  7,   1,   1,  6  },
        {  84,  7,   2,   1,  6  },
        {  85,  7,   1,   1,  6  },
        {  86,  0,   1,   2,  6  },
        {  87,  0,   1,   2,  6  },
        {  88,  7,   1,   1,  6  },
        {  89,  2,   2,   6,  2  },
        {  90,  2,   2,   6,  2  },
        {  91,  2,   2,   6,  2  },
        {  92,  2,   2,   6,  2  },
        {  93,  2,   2,   6,  2  },
        {  94,  2,   1,   6,  2  },
        {  95,  8,   1,   3,  2  },
        {  96,  2,   1,   6,  2  },
        {  97,  8,   1,   3,  2  },
        {  98,  8,   2,   3,  2  },
        {  99,  2,   1,   6,  2  },
        { 100,  2,   2,   6,  2  },
        { 101,  2,   1,   6,  2  },
        { 102,  8,   1,   3,  2  },
        { 103,  2,   1,   6,  2  },
        { 104,  8,   1,   3,  2  },
        { 105,  8,   1,   3,  2  },
        { 106,  2,   1,   6,  2  },
        { 107,  8,   1,   3,  2  },
        { 108,  8,   2,   3,  2  },
        { 109,  2,   1,   6,  2  },
        { 110,  2,   1,   6,  2  },
        { 111,  8,   1,   3,  2  },
        { 112,  0,   2,   1,  12 },
        { 113,  0,   1,   1,  12 },
        { 114,  0,   2,   1,  12 },
        { 115,  0,   1,   1,  12 },
        { 116,  0,   2,   1,  12 },
        { 117,  0,   1,   1,  12 },
        { 118,  0,   2,   1,  12 },
        { 119,  0,   1,   1,  12 },
        { 120,  2,   2,   1,  12 },
        { 121,  0,   1,   1,  12 },
        { 122,  0,   2,   1,  12 },
        { 123,  0,   1,   1,  12 },
        { 124,  2,   2,   1,  12 },
        { 125,  0,   1,   1,  12 },
        { 126,  2,   1,   1,  12 },
        { 127,  2,   2,   1,  12 },
        { 128,  0,   2,   1,  12 },
        { 129,  0,   1,   1,  12 },
        { 130,  0,   2,   1,  12 },
        { 131,  0,   1,   1,  12 },
        { 132,  2,   2,   1,  12 },
        { 133,  0,   1,   1,  12 },
        { 134,  2,   1,   1,  12 },
        { 135,  0,   1,   1,  12 },
        { 136,  2,   2,   1,  12 },
        { 137,  2,   2,   1,  12 },
        { 138,  0,   1,   1,  12 },
        { 139,  2,   1,   1,  12 },
        { 140,  2,   1,   1,  12 },
        { 141,  0,   2,   1,  12 },
        { 142,  0,   1,   1,  12 },
        { 143,  2,   1,   1,  12 },
        { 144,  0,   2,   7,  2  },
        { 145,  0,   1,   7,  2  },
        { 146,  0,   1,   7,  2  },
        { 147,  0,   1,   7,  2  },
        { 148,  0,   2,   7,  2  },
        { 149,  0,   1,   7,  2  },
        { 150,  0,   2,   7,  2  },
        { 151,  0,   1,   7,  2  },
        { 152,  0,   2,   7,  2  },
        { 153,  0,   1,   7,  2  },
        { 154,  0,   2,   7,  2  },
        { 155,  0,   1,   7,  2  },
        { 156,  8,   1,   3,  2  },
        { 157,  0,   1,   7,  2  },
        { 158,  8,   1,   3,  2  },
        { 159,  8,   2,   3,  2  },
        { 160,  0,   1,   7,  2  },
        { 161,  0,   2,   7,  2  },
        { 162,  8,   1,   3,  2  },
        { 163,  0,   1,   7,  2  },
        { 164,  0,   1,   7,  2  },
        { 165,  8,   1,   3,  2  },
        { 166,  8,   1,   3,  2  },
        { 167,  0,   1,   7,  2  },
        { 168,  8,   2,   3,  2  },
        { 169,  8,   1,   3,  2  },
        { 170,  0,   1,   7,  2  },
        { 171,  0,   1,   7,  2  },
        { 172,  8,   1,   3,  2  },
        { 173,  0,   2,   2,  6  },
        { 174,  0,   1,   2,  6  },
        { 175,  0,   2,   2,  6  },
        { 176,  0,   1,   2,  6  },
        { 177,  0,   2,   2,  6  },
        { 178,  0,   1,   2,  6  },
        { 179,  0,   2,   2,  6  },
        { 180,  0,   1,   2,  6  },
        { 181,  2,   2,   2,  6  },
        { 182,  0,   1,   2,  6  },
        { 183,  0,   2,   2,  6  },
        { 184,  0,   1,   2,  6  },
        { 185,  2,   1,   2,  6  },
        { 186,  0,   1,   2,  6  },
        { 187,  7,   1,   1,  6  },
        { 188,  7,   2,   1,  6  },
        { 189,  0,   1,   2,  6  },
        { 190,  2,   2,   2,  6  },
        { 191,  2,   1,   2,  6  },
        { 192,  7,   1,   1,  6  },
        { 193,  7,   2,   1,  6  },
        { 194,  0,   1,   2,  6  },
        { 195,  7,   2,   1,  6  },
        { 196,  2,   1,   2,  6  },
        { 197,  7,   2,   1,  6  },
        { 198,  7,   1,   1,  6  },
        { 199,  0,   1,   2,  6  },
        { 200,  0,   1,   2,  6  },
        { 201,  7,   1,   1,  6  },
        { 202,  2,   1,   6,  2  },
        { 203,  2,   1,   6,  2  },
        { 204,  2,   1,   6,  2  },
        { 205,  2,   1,   6,  2  },
        { 206,  2,   1,   6,  2  },
        { 207,  2,   1,   6,  2  },
        { 208,  2,   1,   6,  2  },
        { 209,  8,   1,   3,  2  },
        { 210,  8,   1,   3,  2  },
        { 211,  2,   1,   6,  2  },
        { 212,  2,   2,   6,  2  },
        { 213,  8,   1,   3,  2  },
        { 214,  2,   1,   6,  2  },
        { 215,  2,   1,   6,  2  },
        { 216,  8,   1,   3,  2  },
        { 217,  2,   1,   6,  2  },
        { 218,  2,   1,   6,  2  },
        { 219,  2,   1,   6,  2  },
        { 220,  2,   1,   3,  4  },
        { 221,  2,   1,   3,  4  },
        { 222,  2,   1,   3,  4  },
        { 223,  2,   1,   3,  4  },
        { 224,  2,   1,   3,  4  },
        { 225,  2,   1,   3,  4  },
        { 226,  2,   1,   3,  4  },
        { 227,  6,   1,   2,  4  },
        { 228,  6,   1,   2,  4  },
        { 229,  2,   1,   3,  4  },
        { 230,  2,   2,   3,  4  },
        { 231,  6,   1,   2,  4  },
        { 232,  2,   1,   3,  4  },
        { 233,  2,   1,   3,  4  },
        { 234,  6,   1,   2,  4  },
        { 235,  2,   1,   3,  4  },
        { 236,  2,   1,   3,  4  },
        { 237,  2,   1,   3,  4  },
        { 238,  2,   1,   2,  6  },
        { 239,  2,   1,   2,  6  },
        { 240,  2,   1,   2,  6  },
        { 241,  2,   1,   2,  6  },
        { 242,  2,   1,   2,  6  },
        { 243,  2,   1,   2,  6  },
        { 244,  2,   1,   2,  6  },
        { 245,  2,   1,   2,  6  },
        { 246,  2,   1,   2,  6  },
        { 247,  2,   1,   2,  6  },
        { 248,  2,   2,   2,  6  },
        { 249,  2,   1,   2,  6  },
        { 250,  2,   1,   2,  6  },
        { 251,  2,   2,   2,  6  },
        { 252,  2,   1,   2,  6  },
        { 253,  2,   2,   2,  6  },
        { 254,  2,   1,   2,  6  },
        { 255,  2,   1,   2,  6  }
    }
};


typedef struct tSSB
{
    int preamble[2];  /* index begin to end */
    int index;
} tSSB;

typedef struct _tAssoc
{
    tSSB ssb[16];
    int  ssbNum;
} tAssoc;

tAssoc g_assoc[8][14];


void help(void)
{
    printf("Usage: ssb_associate_1 [OPTION]...\n");
    printf("\n");
    printf("  -f value   Frequency range (0: FR1 paired, 1: FR1 unpaired, 2: FR2).\n");
    printf("  -u value   PRACH subcarrier spacing (1.25, 5, 15, 30, 60, 120).\n");
    printf("  -c value   PRACH configuration index (0 ~ 255).\n");
    printf("  -m value   msg1-FDM (1, 2, 4, 8).\n");
    printf("  -s value   msg1-FrequencyStart (0 ~ 274).\n");
    printf("  -n value   SSB per RACH occasion (N: 1/8, 1/4, 1/2, 1, 2, 4, 8, 16).\n");
    printf("  -r value   Contention based preambles per SSB (R: 1 ~ 64).\n");
    printf("  -t value   Total number of RA preambles (1 ~ 64).\n");
    printf("  -l value   Number of SSB in a half frame (4, 8, 64).\n");
    printf("  -h         Show the help message.\n");
    printf("\n");
}

/* 38.213 Section 8.1 Random access preamble */
int main(int argc, char *argv[])
{
    int FR = 0;
    char *prachSCS = "15";
    int configIndex = 87;
    int M = 4;
    int freqStart = 0;
    char *ssb_perRACH_Occasion = "1";
    int N = 1;
    int R = 32;
    int N_total_preamble = 64;
    int L_max = 4;

    int u = PRACH_SCS_1D25_5_15_60;
    int n_RA;
    int N_abs;
    int slots;
    int N_RA_slot;
    int ssbIndex;
    int ch;
    int i;
    int j;
    int k;
    int n;
    int t;


    opterr = 0;
    while ((ch=getopt(argc, argv, "f:u:c:m:s:n:r:t:l:h")) != -1)
    {
        switch ( ch )
        {
            case 'f':
                FR = atoi( optarg );
                if (FR > 2) FR = 0;
                break;
            case 'u':
                prachSCS = optarg;
                break;
            case 'c':
                configIndex = (atoi( optarg ) & 0xFF);
                break;
            case 'm':
                M = atoi( optarg );
                if ((M != 1) && (M != 2) && (M != 4) && (M != 8))
                {
                    printf("ERR: wrong msg1-FDM %s\n\n", optarg);
                    return 0;
                }
                break;
            case 's':
                freqStart = atoi( optarg );
                if ((freqStart < 0) || (freqStart > 274))
                {
                    printf("ERR: wrong msg1-FrequencyStart %s\n\n", optarg);
                    return 0;
                }
                break;
            case 'n':
                ssb_perRACH_Occasion = optarg;
                break;
            case 'r':
                R = atoi( optarg );
                break;
            case 't':
                N_total_preamble = atoi( optarg );
                if ((N_total_preamble < 1) || (N_total_preamble > 64))
                {
                    printf("ERR: wrong totalNumberOfRA-Preambles %s\n\n", optarg);
                    return 0;
                }
                break;
            case 'l':
                L_max = atoi( optarg );
                if ((L_max != 4) && (L_max != 8) && (L_max != 64))
                {
                    printf("ERR: wrong L_max %s\n\n", optarg);
                    return 0;
                }
                break;
            case 'h':
            default:
                help();
                return 0;
        }
    }


    if ((0 == FR) || (1 == FR))
    {
        if ((0 == strcmp("1.25", prachSCS)) ||
            (0 == strcmp("5", prachSCS)) ||
            (0 == strcmp("15", prachSCS)))
        {
            u = PRACH_SCS_1D25_5_15_60;
        }
        else if (0 == strcmp("30", prachSCS))
        {
            u = PRACH_SCS_30_120;
        }
        else
        {
            printf("ERR: wrong PRACH subcarrier spacing %s (FR1)\n\n", prachSCS);
            return 0;
        }
    }
    else
    {
        if (0 == strcmp("60", prachSCS))
        {
            u = PRACH_SCS_1D25_5_15_60;
        }
        else if (0 == strcmp("120", prachSCS))
        {
            u = PRACH_SCS_30_120;
        }
        else
        {
            printf("ERR: wrong PRACH subcarrier spacing %s (FR2)\n\n", prachSCS);
            return 0;
        }
    }


    if (0 == strcmp("1/8", ssb_perRACH_Occasion))
    {
        N = -8;
        if (((R / 4) < 1) || ((R / 4) > 16))
        {
            printf("ERR: wrong CB-PreamblesPerSSB %d\n\n", R);
            return 0;
        }
    }
    else if (0 == strcmp("1/4", ssb_perRACH_Occasion))
    {
        N = -4;
        if (((R / 4) < 1) || ((R / 4) > 16))
        {
            printf("ERR: wrong CB-PreamblesPerSSB %d\n\n", R);
            return 0;
        }
    }
    else if (0 == strcmp("1/2", ssb_perRACH_Occasion))
    {
        N = -2;
        if (((R / 4) < 1) || ((R / 4) > 16))
        {
            printf("ERR: wrong CB-PreamblesPerSSB %d\n\n", R);
            return 0;
        }
    }
    else if (0 == strcmp("1", ssb_perRACH_Occasion))
    {
        N = 1;
        if (((R / 4) < 1) || ((R / 4) > 16))
        {
            printf("ERR: wrong CB-PreamblesPerSSB %d\n\n", R);
            return 0;
        }
    }
    else if (0 == strcmp("2", ssb_perRACH_Occasion))
    {
        N = 2;
        if (((R / 4) < 1) || ((R / 4) > 8))
        {
            printf("ERR: wrong CB-PreamblesPerSSB %d\n\n", R);
            return 0;
        }
    }
    else if (0 == strcmp("4", ssb_perRACH_Occasion))
    {
        N = 4;
        if ((R < 1) || (R > 16))
        {
            printf("ERR: wrong CB-PreamblesPerSSB %d\n\n", R);
            return 0;
        }
    }
    else if (0 == strcmp("8", ssb_perRACH_Occasion))
    {
        N = 8;
        if ((R < 1) || (R > 8))
        {
            printf("ERR: wrong CB-PreamblesPerSSB %d\n\n", R);
            return 0;
        }
    }
    else if (0 == strcmp("16", ssb_perRACH_Occasion))
    {
        N = 16;
        if ((R < 1) || (R > 4))
        {
            printf("ERR: wrong CB-PreamblesPerSSB %d\n\n", R);
            return 0;
        }
    }
    else
    {
        printf("ERR: wrong ssb-perRACH-Occasion %s\n\n", ssb_perRACH_Occasion);
        return 0;
    }

    if ((N_total_preamble % N) != 0)
    {
        printf("ERR: wrong totalNumberOfRA-Preambles %d\n\n", N_total_preamble);
        return 0;
    }


    N_abs = abs( N );
    if (PRACH_SCS_1D25_5_15_60 == u)
    {
        slots = 1;
    }
    else
    {
        slots = g_raConfig[FR][configIndex][2];
    }
    N_RA_slot = g_raConfig[FR][configIndex][3];

    k = 0;
    ssbIndex = 0;
    for (j=0; j<slots; j++)
    {
        for (i=0; i<N_RA_slot; i++)
        {
            for (n_RA=0; n_RA<M; n_RA++)
            {
                if (N < 0)
                {
                    g_assoc[n_RA][k].ssb[0].preamble[0] = 0;
                    g_assoc[n_RA][k].ssb[0].preamble[1] = (R - 1);
                    g_assoc[n_RA][k].ssb[0].index = ssbIndex;
                    g_assoc[n_RA][k].ssbNum = 1;
                    N_abs--;
                    if (N_abs <= 0)
                    {
                        N_abs = abs( N );
                        ssbIndex++;
                        if (ssbIndex >= L_max) ssbIndex = 0;
                    }
                }
                else
                {
                    for (n=0; n<N; n++)
                    {
                        g_assoc[n_RA][k].ssb[n].preamble[0] = ((n * N_total_preamble) / N);
                        g_assoc[n_RA][k].ssb[n].preamble[1] = (g_assoc[n_RA][k].ssb[n].preamble[0] + (R - 1));
                        g_assoc[n_RA][k].ssb[n].index = ssbIndex;
                        g_assoc[n_RA][k].ssbNum = (n + 1);
                        ssbIndex++;
                        if (ssbIndex >= L_max) ssbIndex = 0;
                    }
                }
            }
            k++;
        }
    }

    printf("SSB L_max = %d\n", L_max);
    printf("PRACH subcarrier spacing = %sKHz\n", prachSCS);
    printf("prach-ConfigurationIndex = %d\n", configIndex);
    printf("msg1-FDM = %d\n", M);
    printf("msg1-FrequencyStart = %d\n", freqStart);
    printf("totalNumberOfRA-Preambles = %d\n", N_total_preamble);
    if (N < 0)
    {
    printf("ssb-perRACH-OccasionAndCB-PreamblesPerSSB = %s, %d\n", ssb_perRACH_Occasion, R);
    }
    else
    {
    printf("ssb-perRACH-OccasionAndCB-PreamblesPerSSB = %d, %d\n", N, R);
    }
    printf("Number of PRACH slots = %d\n", slots);
    printf("N_RA_slot = %d\n", N_RA_slot);
    printf("\n");
    printf("RO   [1;36mT[0m\n");
    t = 0;
    for (n_RA=M; n_RA>=0; n_RA--)
    {
        k = 0;
        if (n_RA == M)
        {
            printf("   ");
        }
        else
        {
            printf(" [1;33m%d[0m ", (n_RA + 1));
        }
        for (j=0; j<slots; j++)
        {
            for (i=0; i<N_RA_slot; i++)
            {
                if (n_RA == M)
                {
                    if (g_assoc[0][k].ssbNum > 8)
                    {
                        printf("  [1;36m%d[0m      ", (t + 1));
                    }
                    else if (g_assoc[0][k].ssbNum > 1)
                    {
                        printf("  [1;36m%d[0m    ", (t + 1));
                    }
                    else
                    {
                        printf("  [1;36m%d[0m  ", (t + 1));
                    }
                    t++;
                    if (t >= N_RA_slot) t = 0;
                }
                else
                {
                    if (g_assoc[n_RA][k].ssbNum > 1)
                    {
                        printf(
                            "[ %d-%d ]",
                            g_assoc[n_RA][k].ssb[0].index,
                            g_assoc[n_RA][k].ssb[g_assoc[n_RA][k].ssbNum-1].index
                        );
                    }
                    else
                    {
                        printf("[ %d ]", g_assoc[n_RA][k].ssb[0].index);
                    }
                }
                k++;
            }
            printf(" ");
        }
        printf("\n");
    }
    printf(" [1;33mF[0m \n");
    printf("\n");

    ssbIndex = 0;
    {
       for (i=0; i<L_max; i++)
       {
           n = (i % g_assoc[0][0].ssbNum);
           printf(
               "SSB[%d] preamble[ %d-%d ]\n",
               ssbIndex,
               g_assoc[0][0].ssb[n].preamble[0],
               g_assoc[0][0].ssb[n].preamble[1]
           );
           ssbIndex++;
           if (ssbIndex >= L_max) ssbIndex = 0;
       }
    }
    printf("\n");

    return 0;
}

